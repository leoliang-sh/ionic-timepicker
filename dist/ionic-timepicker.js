angular.module("ionic-timepicker",["ionic","ionic-timepicker.templates"]).directive("ionicTimepicker",["$ionicPopup",function(t){return{restrict:"AE",replace:!0,scope:{itime:"=itime",format:"=format",step:"=step"},link:function(e,i){i.on("click",function(){var i={time:e.itime,step:e.step,format:e.format};e.time={hours:0,minutes:0,meridian:""};var m=new Date(i.time);e.increaseHours=function(){e.time.hours=Number(e.time.hours),12==i.format&&(12!=e.time.hours?e.time.hours+=1:e.time.hours=1),24==i.format&&(23!=e.time.hours?e.time.hours+=1:e.time.hours=0),e.time.hours=e.time.hours<10?"0"+e.time.hours:e.time.hours},e.decreaseHours=function(){e.time.hours=Number(e.time.hours),12==i.format&&(e.time.hours>1?e.time.hours-=1:e.time.hours=12),24==i.format&&(e.time.hours>0?e.time.hours-=1:e.time.hours=23),e.time.hours=e.time.hours<10?"0"+e.time.hours:e.time.hours},e.increaseMinutes=function(){e.time.minutes=Number(e.time.minutes),e.time.minutes!=60-i.step?e.time.minutes+=i.step:e.time.minutes=0,e.time.minutes=e.time.minutes<10?"0"+e.time.minutes:e.time.minutes},e.decreaseMinutes=function(){e.time.minutes=Number(e.time.minutes),0!==e.time.minutes?e.time.minutes-=i.step:e.time.minutes=60-i.step,e.time.minutes=e.time.minutes<10?"0"+e.time.minutes:e.time.minutes},12==i.format&&(e.time.meridian=m.getHours()>=12?"下午":"上午",e.time.hours=m.getHours()>12?m.getHours()-12:m.getHours(),e.time.minutes=m.getMinutes(),0===e.time.hours&&"上午"==e.time.meridian&&(e.time.hours=12),e.changeMeridian=function(){e.time.meridian="上午"===e.time.meridian?"下午":"上午"},t.show({cssClass:"ionic-timepicker",templateUrl:"time-picker-12-hour.html",title:"<strong>12小时格式</strong>",subTitle:"",scope:e,buttons:[{text:"关闭"},{text:"设置",type:"button-positive",onTap:function(){function t(t,e){return"下午"===e&&(t+=12),t%24}e.loadingContent=!0;var i=t(e.time.hours,e.time.meridian)+":"+e.time.minutes,s=m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate();isNaN(tmpItime)&&(tmpItime=Date.parse(s.replace(/-/g,"/")+" "+i)),e.itime=tmpItime}}]})),24==i.format&&(e.time.hours=m.getHours()<10?"0"+m.getHours():m.getHours(),e.time.minutes=m.getMinutes()<10?"0"+m.getMinutes():m.getMinutes(),t.show({cssClass:"ionic-timepicker",templateUrl:"time-picker-24-hour.html",title:"<strong>24小时格式</strong>",subTitle:"",scope:e,buttons:[{text:"关闭"},{text:"设置",type:"button-positive",onTap:function(){e.loadingContent=!0;var t=e.time.hours+":"+e.time.minutes,i=m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate(),s=Date.parse(i+" "+t);isNaN(s)&&(s=Date.parse(i.replace(/-/g,"/")+" "+t)),e.itime=s}}]}))})}}}]);